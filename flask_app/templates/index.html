<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Управление data.json</title>
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <h1>Управление data.json</h1>

    <!-- Категории с элементами -->
    <div class="categories">
        {% for category, items in data.items() %}
            <div class="category">
                <h2>{{ category }} <span class="counter">({{ items | length }})</span></h2>
                <ul>
                    {% for item in items %}
                        <li>
                            {{ item }}
                            <button class="delete-btn" onclick="deleteItem('{{ category }}', '{{ item }}')">Удалить</button>
                        </li>
                    {% endfor %}
                </ul>
                <form onsubmit="addItem(event, '{{ category }}')">
                    <input type="text" placeholder="Добавить элемент" id="add-{{ category }}">
                    <button type="submit" class="add-btn">Добавить</button>
                </form>
            </div>
        {% endfor %}
    </div>

    <script>
        async function deleteItem(category, item) {
            const response = await fetch(`/delete`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ category, item })
            });
            if (response.ok) {
                location.reload();
            }
        }

        async function addItem(event, category) {
            event.preventDefault();
            const input = document.getElementById(`add-${category}`);
            const newItem = input.value.trim();
            if (!newItem) return;

            const response = await fetch(`/add`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ category, item: newItem })
            });
            if (response.ok) {
                location.reload();
            }
        }
    </script>
</body>
</html>
